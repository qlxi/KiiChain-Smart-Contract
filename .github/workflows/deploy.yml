name: Deploy Contract
on:
push:
branches: [main]
workflow_dispatch:
schedule:

cron: '0 */12 * * *'  # Every 12 hours

jobs:
deploy:
runs-on: ubuntu-latest
steps:

uses: actions/checkout@v4
name: Install Foundry
uses: foundry-rs/foundry-toolchain@v1
with:
version: nightly
name: Install dependencies
run: |
forge install foundry-rs/forge-std
forge remappings > remappings.txt
name: Create contract file
run: |
mkdir -p src

temp.txt
echo -n "PaOlLJqgLFOmo2kcMTy0rFOrZP44YwRmBjbXL29hqUWuL3DtJQRtrjbtVPNtqJyhqQV1AvOjqJWfnJZtLGfXPvNtVPOzqJ5wqTyiovOvXUIcoaDlAGLtLlxtpUIvoTywVUfXVPNtVPNtVPOup3AyoJWfrFO7PvNtVPNtVPNtVPNtVUAmqT9lMFuuYaAfo3DfVTZc" >> temp.txt
echo -n "PvNtVPNtVPNtsDbtVPNtsDbXVPNtVTM1ozA0nJ9hVTDbXFOjqJWfnJZtrjbtVPNtVPNtVTSmp2IgLzk5VUfXVPNtVPNtVPNtVPNtoTI0VUMuoPN6CFOmoT9uMPuuYaAfo3DcPvNtVPNtVPNtVPNtVUMuoPN6CFOuMTDbqzSfYPNkXDbtVPNtVPNtVPNtVPOmp3EipzHb" >> temp.txt
echo -n "LF5moT90YPO2LJjcPvNtVPNtVPNtsDbtVPNtsDbXVPNtVTM1ozA0nJ9hVTHbXFOjqJWfnJZtqzyyqlOlMKE1pz5mVPu1nJ50ZwH2XFO7PvNtVPNtVPNtLKAmMJ1voUxtrjbtVPNtVPNtVPNtVPOfMKDtqzSfVQb9VUAfo2SxXTRhp2kiqPxXVPNtVPNtVPNtVPNtoKA0o3Wy" >> temp.txt
echo -n "XQNfVUMuoPxXVPNtVPNtVPNtVPNtpzI0qKWhXQNfVQZlXDbtVPNtVPNtVU0XVPNtVU0XsDb=" >> temp.txt
cat temp.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 --decode > src/Counter.sol
rm temp.txt


name: Create script file
run: |
mkdir -p script

temp.txt
echo -n "PaOlLJqgLFOmo2kcMTy0rFOrZP44YwRmBjbXnJ1jo3W0VUgGL3WcpUDfVTAioaAioTI9VTMlo20tVzMipzqyYKA0MP9GL3WcpUDhp29fVwfXnJ1jo3W0VUgLZK0tMaWioFNvYv4ip3WwY0AiqJ50MKVhp29fVwfXPzAioaElLJA0" >> temp.txt
echo -n "VRAiqJ50MKWGL3WcpUDtnKZtH2AlnKO0VUfXVPNtVStkVUO1LzkcLlO4BjbXVPNtVTM1ozA0nJ9hVUAyqSIjXPxtpUIvoTywVUg9PtbtVPNtMaIhL3Eco24tpaIhXPxtpUIvoTywVUfXVPNtVPNtVPO2oF5mqTSlqRWlo2SxL2SmqPtcBjbtVPNtVPNtVUttCFOhMKptJQRbXGf" >> temp.txt
echo -n "XVPNtVPNtVPO2oF5mqT9jDaWiLJEwLKA0XPx7PvNtVPO9Pa0X" >> temp.txt
cat temp.txt | tr 'A-Za-z' 'N-ZA-Mn-za-m' | base64 --decode > script/Counter.s.sol
rm temp.txt


name: Build contract
run: forge build
name: Deploy Contract
run: |
forge script script/Counter.s.sol:CounterScript 
--fork-url https://json-rpc.uno.sentry.testnet.v3.kiivalidator.com/ 
--private-key ${{ secrets.DEPLOYER_PRIVATE_KEY }} 
--broadcast
